REM Mahjong for PC-1261/PC1262
REM 2/9/2026
REM Shigeyuki Seko
REM
10 DIM X(34,6):DIM D(13)
20 WAIT 0:PRINT "Mahjong Ver 1.0 by Seko"
40 P=0,H=0,Z=0
70 FOR I=0 TO 33
80 X(I,6)=0
90 FOR J=0 TO 4
100 READ X(I,J)
110 NEXT J
120 NEXT I
130 WAIT 0:PRINT "1234567890123 Time:";Z:CALL &043B
150 GOSUB "HAIPAI"
160 Z=Z+1
190 GOSUB "DISP"
200 P=14
210 GOSUB "TSUMO"
220 WAIT
230 IF INKEY$="" GOTO 230
240 INPUT "INPUT No.1-14:";S
250 IF S<=0 OR S>14 GOTO 240
260 IF S<14 LET D(S-1)=F
265 WAIT 0:PRINT "OK PLEASE WAIT..."
270 GOTO 160
280 END
REM
REM DISPLAY
REM
300 "DISP" 
310 FOR I = 0 TO 11
320 FOR J = 0 TO 11
330 IF D(J)<=D(J+1) GOTO 370
340 T=D(J):D(J)=D(J+1):D(J+1)=T
370 NEXT J
380 NEXT I
410 P=0
420 WAIT 0:PRINT "1234567890123 Time:";Z:CALL &043B
430 FOR I=0 TO 12
440 H=D(I)
450 GOSUB "DRAW"
460 P=P+1
470 NEXT I
480 RETURN
REM
REM HAIPAI
REM
500 "HAIPAI"
510 J=0,P=0
520 FOR I=0 TO 12
530 GOSUB "TSUMO"
540 P=P+1:D(I)=F
560 NEXT I
570 RETURN
REM
REM TSUMO
REM
600 "TSUMO" 
610 F=(RND 34)-1
620 IF(X(F,6)>=3)GOTO "TSUMO"
630 X(F,6)=X(F,6)+1:H=F
640 GOSUB "DRAW"
650 RETURN
REM
REM DRAW CHR
REM
700 "DRAW"
710 IF P<0 OR P>24 RETURN
730 IF P>11 GOTO 760
740 POKE &2040+(P*5),X(H,0),X(H,1),X(H,2),X(H,3),X(H,4)
750 RETURN
760 POKE &2840+((P-12)*5),X(H,0),X(H,1),X(H,2),X(H,3),X(H,4)
780 RETURN
REM
REM SOZU 0-8 
801 DATA &00,&00,&1C,&00,&00
802 DATA &00,&00,&77,&00,&00
803 DATA &00,&70,&07,&70,&00
804 DATA &00,&77,&00,&77,&00
805 DATA &77,&00,&1C,&00,&77
806 DATA &77,&00,&77,&00,&77
807 DATA &6C,&00,&6D,&00,&6C
808 DATA &77,&14,&22,&14,&77
809 DATA &6D,&00,&6D,&00,&6D
REM PIN 9-17
811 DATA &00,&08,&1C,&08,&00
812 DATA &00,&22,&77,&22,&00
813 DATA &03,&0B,&1C,&68,&60
814 DATA &63,&63,&00,&63,&63
815 DATA &63,&6B,&1C,&6B,&63
816 DATA &6D,&6D,&00,&6D,&6D
817 DATA &51,&53,&06,&54,&54
818 DATA &55,&55,&00,&55,&55
819 DATA &6D,&6D,&6D,&6D,&6D
REM MANZU 18-26
821 DATA &08,&08,&08,&08,&08
822 DATA &20,&22,&22,&22,&20
823 DATA &41,&49,&49,&49,&41
824 DATA &7F,&51,&4F,&51,&7F
825 DATA &49,&7F,&49,&79,&41
826 DATA &44,&34,&05,&34,&44
827 DATA &04,&7F,&44,&44,&44
828 DATA &60,&1F,&00,&1F,&60
829 DATA &42,&3F,&02,&7E,&40
REM TON 27
831 DATA &5A,&3A,&7F,&3A,&5A
REM NAN 28
832 DATA &7A,&1A,&6F,&1A,&7A
REM SHA 29
833 DATA &7D,&67,&5D,&67,&7D
REM PEI 30
834 DATA &44,&7F,&00,&7F,&44
REM HAKU 31
835 DATA &7F,&41,&41,&41,&7F
REM HATSU 32
836 DATA &2E,&7B,&2A,&7B,&2E
REM TYUN 33
837 DATA &1E,&12,&7F,&12,&1E